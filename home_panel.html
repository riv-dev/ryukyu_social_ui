<p ng-if="!loggedin_user" class="message main">Welcome to Ryukyu Social</p>
<p ng-if="!loggedin_user" class="message main">Please <a href="./login">log in</a></p>

<section ng-if="loggedin_user" id="tasks_section" class="section">
    <header class="section_header">
        <h2 class="title">Company Task Board</h2>
        <ul class="links">
            <li class="item"><select class="input select" ng-options="task_status for task_status in statuses" ng-change="getTasks(task_status)" ng-model="task_status"></select></li>
            <li class="item"><a href="./tasks/new">Add Task</a></li>
        </ul>
    </header>
    <ul id="tasks_list" class="section_information">
        <li class="item {{task.status}} {{archivedClass(task.archived)}}" ng-repeat="task in tasks">
            <a href="./tasks/{{task.id}}">
                <h3 class="name">{{task.name}}</h3>
                <p class="info description">{{task.description}}</p>
                <dl class="attributes">
                    <dt class="key assigned_to">Assigned to:</dt>
                    <dd class="value_item assigned_to {{cssLast($last)}}" ng-repeat="task_user in task.users">
                        <em class="key user">{{task_user.firstname}} {{task_user.lastname}}: </em>
                        <p class="value user">{{task_user.progress_description}}</p>
                    </dd>
                    <dd class="value value--none assigned_to" ng-if="!task.users || task.users.length == 0">
                        Need Assignee
                    </dd>
                    <dt class="key status">Status:</dt>
                    <dd class="value status {{task.status}}" ng-if="task.status">{{task.status}}</dd>
                    <dt class="key priority">Priority:</dt>
                    <dd class="value priority {{checkPriorityImportance(task.priority)}}" ng-if="task.priority">{{getPriorityLabel(task.priority)}}</dd>
                    <dd class="value value--none priority" ng-if="!task.priority">Not defined</dd>     
                    <dt class="key deadline">Deadline:</dt>
                    <dd class="value deadline {{checkDateImportance(task.deadline, task.status)}}" ng-if="task.deadline">{{prettyDate(task.deadline, task.status)}}</dd>
                    <dd class="value value--none deadline" ng-if="!task.deadline">Not defined</dd>
                    <dt class="key project">Project:</dt>
                    <dd class="value project" ng-if="task.project_name">{{task.project_name}}</dd>
                    <dd class="value value--none project" ng-if="!task.project_name">Not Assigned</dd>
                </dl>
            </a>
        </li>
    </ul>
</section>

<section ng-if="loggedin_user" id="projects_section" class="section">
    <header class="section_header">
        <h2 class="title">Projects List</h2>
        <ul class="links">
            <li class="item"><select class="input select" ng-options="project_status for project_status in statuses" ng-change="getProjects(project_status)" ng-model="project_status"></select></li>
            <li class="item"><a href="./projects/new">Add Project</a></li>
        </ul>
    </header>
    <ul id="projects_list" class="section_information">
        <li class="item {{project.status}}" ng-repeat="project in projects">
            <a href="./projects/{{project.id}}">
                <h3 class="name">{{project.name}}</h3>
                <dl class="attributes">
                    <dt class="key users">Users:</dt>
                    <dd class="value_item users  {{cssLast($last)}}" ng-repeat="project_user in project.users">
                        <em class="key role" ng-if="project_user.role">{{project_user.role}}: </em>
                        <em class="key key--none role" ng-if="!project_user.role">Undefined Role: </em>
                        <p class="value role">{{project_user.firstname}} {{project_user.lastname}}</p>
                    </dd>
                    <dd class="value value--none users" ng-if="!project.users || project.users.length == 0">No users assigned</dd>
                    <dt class="key status">Status:</dt>
                    <dd class="value status {{project.status}}" ng-if="project.status">{{project.status}}</dd>
                    <dt class="key start_date">Start Date:</dt>
                    <dd class="value start_date" ng-if="project.start_date">{{prettyDate(project.start_date)}}</dd>
                    <dd class="value value--none start_date" ng-if="!project.start_date">Not defined</dd>
                    <dt class="key deadline">Deadline:</dt>
                    <dd class="value deadline {{checkDateImportance(project.deadline, project.status)}}" ng-if="project.deadline">{{prettyDate(project.deadline, project.status)}}</dd>
                    <dd class="value value--none deadline" ng-if="!project.deadline">Not defined</dd>
                    <dt class="key tasks_rank">Top Tasks:</dt>
                    <dd class="value_item tasks_rank {{cssLast($last)}}" ng-repeat="project_task in project.tasks">
                        <span class="key rank">{{$index + 1}}</span>
                        <p class="value rank">{{project_task.name}}</p>
                    </dd>
                    <dd class="value value--none tasks" ng-if="!project.tasks || project.tasks.length == 0">No tasks</dd>
                </dl>
            </a>
        </li>
    </ul>
</section>

<section ng-if="loggedin_user" id="users_section" class="section">
    <header class="section_header">
        <h2 class="title">Users List</h2>
        <ul class="links">
            <li ng-if="loggedin_user.admin" class="item"><a href="./users/new">Add User</a></li>
        </ul>
    </header>
    <ul id="users_list" class="section_information">
        <li class="item" ng-repeat="user in users">
            <a href="./users/{{user.id}}">
                <h3 class="key user">{{user.title}}</h3>
                <p class="value user">{{user.firstname}} {{user.lastname}}</p>
            </a>
        </li>
    </ul>
</section>